# Calorie Tracker API

Это Spring Boot приложение для контроля калорийности питания. В проекте реализованы REST API для работы с пользователями, блюдами, приемами пищи и отчетами. Документация API доступна через Swagger, а также приложена Postman коллекция для проверки эндпоинтов.

## Запуск проекта через Maven

### Запуск приложения

Для запуска приложения через Maven используйте команду:

```bash
mvn spring-boot:start
```

Эта команда соберет и запустит приложение. Оно будет доступно по адресу [http://localhost:8080](http://localhost:8080).

### Запуск тестов

Для запуска юнит-тестов выполните:

```bash
mvn test
```

Maven запустит тесты для сервисов (и других модулей), используя JUnit 5 и Mockito.

## Запуск через Docker

В проекте предоставлен `Dockerfile` для сборки WAR-файла и `docker-compose.yml` для поднятия контейнеров.

### Описание слоев и сервисов

- **docker-compose.yml**  
  Определены следующие сервисы:
  - **pgdb:** PostgreSQL (образ `postgres:16.0-alpine`) с базой данных `diet`. Служит для хранения данных.
  - **app:** Приложение (собранное через Dockerfile) с переменными окружения для подключения к БД, настройки Liquibase и JPA. Зависит от сервиса pgdb.
  - **pgadmin:** Веб-интерфейс для управления PostgreSQL (образ `dpage/pgadmin4`), доступный по [http://127.0.0.1:5050](http://127.0.0.1:5050).
  - **app-test:** Контейнер с Maven и OpenJDK, предназначенный для запуска тестов (команда `mvn test`). Зависит от pgdb.

### Команды для сборки и запуска

1. **Сборка Docker-образа приложения:**  
   Выполните команду в корне проекта (где находится Dockerfile):
   ```bash
   docker-compose build app
   ```

2. **Запуск контейнеров:**  
   Чтобы запустить все сервисы, выполните:
   ```bash
   docker-compose up -d
   ```
   Это запустит:
   - PostgreSQL (pgdb)
   - Приложение (app) – доступно по [http://localhost:8080](http://localhost:8080)
   - PgAdmin (pgadmin) – доступно по [http://127.0.0.1:5050](http://127.0.0.1:5050)
   - Контейнер для тестов (app-test) – запустит `mvn test` и завершится после выполнения тестов.

3. **Остановка контейнеров:**  
   Чтобы остановить все контейнеры, выполните:
   ```bash
   docker-compose down
   ```

## Документация API

Swagger UI доступен по адресу:  
[http://localhost:8080/swagger-ui/index.html](http://localhost:8080/swagger-ui/index.html)

Здесь вы можете ознакомиться с описанием всех эндпоинтов, протестировать их и посмотреть модели данных.

## Postman коллекция

В репозитории присутствует Postman коллекция под именем `Calorie Tracker API.postman_collection`. Она содержит примеры запросов для работы с API (создание пользователя, добавление блюд, приемы пищи, отчеты и т.д.). Импортируйте коллекцию в Postman для быстрого тестирования API.

---
